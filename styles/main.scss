:root {
	--font-family: 'Open Sans', sans-serif;
	--font-family-alt: 'Vollkorn', sans-serif;
	--font-weight: 400;
	--font-weight-bold: 600;
	--background-color: #ffffff;
	--gradient-start: var(--background-color);
	--gradient-end: hsl(193, 32%, 91%);

	--text-color: hsl(0, 0%, 27%);
	--link-color: hsl(180, 2%, 35%);
	--nav-link-color: hsl(216, 14%, 48%);

	// Fluid typography variables
	--font-size-base: 1.125rem; // Fallback: 18px
	--font-size-sm: 0.875rem; // Fallback: 14px
	--font-size-lg: 1.25rem; // Fallback: 20px

	// Headings with better scale - following a 1.25 ratio (Major Third)
	--font-size-h1: 2.5rem; // Fallback: 40px
	--font-size-h2: 2rem; // Fallback: 32px
	--font-size-h3: 1.625rem; // Fallback: 26px
	--font-size-h4: 1.375rem; // Fallback: 22px
	--font-size-h5: 1.25rem; // Fallback: 20px
	--font-size-h6: 1.125rem; // Fallback: 18px
}

// Use clamp for modern browsers
@supports (font-size: clamp(1rem, 2vw, 2rem)) {
	:root {
		// Formula: min + (max - min) * (100vw - min-vw) / (max-vw - min-vw)
		--font-size-base: clamp(1.125rem, 1.05rem + 0.375vw, 1.25rem);
		--font-size-sm: clamp(0.875rem, 0.825rem + 0.25vw, 1rem);
		--font-size-lg: clamp(1.25rem, 1.15rem + 0.5vw, 1.5rem);

		// Headings with clear visual hierarchy
		--font-size-h1: clamp(2rem, 1.2rem + 4vw, 3.5rem);
		--font-size-h2: clamp(1.75rem, 1.15rem + 3vw, 2.75rem);
		--font-size-h3: clamp(1.5rem, 1.1rem + 2vw, 2.25rem);
		--font-size-h4: clamp(1.3125rem, 1.05rem + 1.3125vw, 1.75rem);
		--font-size-h5: clamp(1.1875rem, 1rem + 0.9375vw, 1.5rem);
		--font-size-h6: clamp(1.125rem, 0.975rem + 0.75vw, 1.375rem);
	}
}

@media (prefers-color-scheme: dark) {
	.mode::after {
		content: 'dark';
	}
}

html {
	min-height: 100%;
	scroll-behavior: smooth;
}

body {
	background-color: var(--background-color);
	color: var(--text-color);
	font-family: var(--font-family);
	font-size: var(--font-size-base);
	font-weight: var(--font-weight);
	line-height: 1.65;
	margin: 0.5em auto 0;
	min-height: 100vh;
	overflow: auto;
	padding: 0.3em 2em;
	text-rendering: optimizeSpeed;
	z-index: 0;

	@media (max-width: 768px) {
		padding: 0.3em 1.25em;
	}
}

body::before {
	content: '';
	position: fixed;
	inset: 0;
	background-image: linear-gradient(180deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
	background-repeat: no-repeat;
	background-attachment: fixed;
	background-size: cover;
	opacity: 0.3;
	pointer-events: none;
	z-index: -1;

	@media (max-width: 768px) {
		background-attachment: scroll; /* prevents color haze on mobile */
	}
}

b,
strong {
	font-weight: 600;
}

h1,
h2,
h3,
h4,
h5,
h6 {
	color: hsl(0, 0%, 20%);
	font-family: var(--font-family-alt);
	font-weight: var(--font-weight-bold);
	line-height: 1.2;
	margin-top: 1.75em;
	margin-bottom: 0.65em;
	text-rendering: optimizeLegibility;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
	text-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
	transition: font-size 0.2s ease-in-out;
}

h1 {
	font-size: var(--font-size-h1);
	letter-spacing: -0.02em;
	margin-top: 0.5em;
}

h2 {
	font-size: var(--font-size-h2);
	letter-spacing: -0.015em;
}

h3 {
	font-size: var(--font-size-h3);
	letter-spacing: -0.01em;
}

h4 {
	font-size: var(--font-size-h4);
}

h5 {
	font-size: var(--font-size-h5);
}

h6 {
	font-size: var(--font-size-h6);
}

@media screen and (min-device-pixel-ratio: 1.5), screen and (min-resolution: 1.5dppx) {
	body {
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
	}
}

// Better focus styles for accessibility
*:focus-visible {
	outline: 2px solid var(--link-color);
	outline-offset: 2px;
	border-radius: 2px;
}

details summary {
	cursor: pointer;
}

img.next-image {
	margin: 0;
}

.prose {
	color: var(--text-color);
	font-size: var(--font-size-base);

	// Optimal reading width (65-75 characters)
	max-width: 68ch;

	p {
		margin-bottom: 1.5em;
		// Prevent orphans and widows for better typography
		orphans: 3;
		widows: 3;
	}

	ul,
	ol {
		margin-bottom: 1.5em;
		padding-left: 1.5em;

		li {
			margin-bottom: 0.5em;
		}
	}

	code {
		font-size: 0.9em;
		padding: 0.125em 0.25em;
		background: rgba(0, 0, 0, 0.05);
		border-radius: 3px;
	}

	pre code {
		padding: 0;
		background: transparent;
	}
}

.prose a {
	color: var(--link-color);
	text-decoration: none;
	border-bottom: 1px dotted;
	transition: border-color 0.2s ease-in-out, color 0.2s ease-in-out;
	padding: 0.125em 0;
	display: inline-block;

	&:hover {
		border-bottom-style: solid;
		color: hsl(180, 2%, 25%);
	}

	&:focus-visible {
		outline: 2px solid var(--link-color);
		outline-offset: 2px;
		border-radius: 2px;
	}
}

.nav-line .nav-link {
	color: var(--nav-link-color);
	transition: color 0.2s ease-in-out;
	padding: 0.5em;

	&:hover {
		color: var(--link-color);
	}
}
